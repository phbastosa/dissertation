%========================================================================
% Modelo para elaboracao de textos academicos: TCC, dissertacoes e teses
% Elaborado pelo GISIS - Grupo de Imageamento Sismico e Inversao Sismica.
%========================================================================
\chapter{Resultados e Discussões}
\label{ch:resultados}

Neste capítulo, procede-se a apresentação meticulosa dos resultados obtidos por meio da comparação entre os métodos propostos por \citeonline{podvin1991finite}, \citeonline{jeong2008fast} e \citeonline{noble2014accurate}. A análise abarca não apenas a precisão no cálculo dos tempos de trânsito, mas também o desempenho computacional de cada abordagem. Após a exposição desses resultados, empreende-se discussões detalhadas e individualizadas sobre cada método.

No contexto da aplicação no modelo homogêneo, reproduz-se fielmente o experimento conduzido no trabalho de \citeonline{cai2023improved}. Este estudo foi marcado pela introdução de inovações em termos de precisão, notadamente no âmbito do \textit{Fast Iterative Method}. A replicação desse experimento visa proporcionar uma comparação direta com as melhorias propostas por \citeonline{cai2023improved}, estabelecendo um cenário claro para a avaliação do desempenho dos métodos estudados.

Por sua vez, a aplicação no modelo de duas camadas reproduz o experimento minuciosamente detalhado por \citeonline{alves2022refraction}. Este cenário específico foi escolhido para avaliar a robustez e aplicabilidade dos métodos em um contexto que simula condições geofísicas controladas. Além disso, essa abordagem proporciona uma perspectiva de escalabilidade, onde o problema é inicialmente concebido em uma escala reduzida e gradualmente aumenta de tamanho ao longo do estudo, permitindo uma análise do comportamento e eficiência dos métodos à medida que a densidade de células no modelo se intensifica.

A aplicação no modelo complexo expande ainda mais esta análise, destacando o comportamento dos tempos de trânsito em face de expressivos contrastes de velocidade. Este cenário mais desafiador representa um ambiente realista. A análise do tempo de execução para cada método, neste contexto, adiciona uma camada crucial à nossa compreensão, considerando as demandas computacionais em simulações mais representativas. Dessa forma, ao explorar os cenários propostos e considerar os aspectos de desempenho obtidos, evidencia-se uma visão sobre a eficácia dos métodos analisados em diferentes contextos, contribuindo para o avanço do conhecimento na área de modelagem sísmica utilizando a equação eikonal.

\section{Aplicação em modelo homogêneo}

A apresentação detalhada dos resultados obtidos é fornecida na Tabela \ref{table_homog}, na qual são destacados os tempos de execução, o erro médio e o erro máximo associados a cada formulação avaliada. A metodologia adotada para a obtenção desses resultados envolveu a execução da implementação proposta por \citeonline{cai2023improved}, a qual foi conduzida no mesmo ambiente computacional. Esse ambiente foi configurado conforme as diretrizes previamente estabelecidas no capítulo de Metodologia, garantindo consistência e comparabilidade nos experimentos.

A escolha de utilizar a implementação de \citeonline{cai2023improved} decorre da sua disponibilidade pública, o que permite uma análise transparente e passível de replicação por outros pesquisadores. A uniformidade nas configurações de execução, proporciona uma base sólida para a avaliação comparativa das formulações em estudo. Essa abordagem metodológica estruturada não apenas promove a transparência e a reprodutibilidade dos resultados, mas também possibilita uma análise mais aprofundada das características de desempenho de cada formulação. Dessa forma, ao apresentar esses dados de maneira clara e concisa, busca-se contribuir para o entendimento do comportamento dos métodos em um ambiente homogêneo, estabelecendo as bases para interpretações mais refinadas.

\begin{table}[H]
	\caption{Tempo de execução, erro médio e máximo em relação a equação analítica para meio homogêneo. Aplicação dos métodos utilizados relacionando com os resultados do experimento de \citeonline{cai2023improved}.}
	\begin{tabular}{r|ccc}
		\multicolumn{1}{c|}{} & Tempo {[}s{]} & Erro médio {[}s{]} & Erro máximo {[}s{]} \\ \hline
		\citeonline{podvin1991finite} & 0,9661        & 0,000273           & 0,000762    \\ \hline
		\citeonline{jeong2008fast}    & 0,6082        & 0,000837           & 0,001323    \\ \hline
		\citeonline{noble2014accurate}& 0,8085        & 0,000037           & 0,000069    \\ \hline
		\citeonline{cai2023improved}  & 1,9312        & 0,000196           & 0,000282           
	\end{tabular}
	\label{table_homog}
\end{table}

No decorrer do teste no modelo homogêneo, conforme evidenciado na Tabela \ref{table_homog}, é possível discernir a superioridade em desempenho do método proposto por \citeonline{jeong2008fast}. Contudo, é relevante observar que, embora esse método tenha apresentado a melhor performance, os erros registrados revelam-se os mais elevados em comparação com as demais abordagens testadas. O método desenvolvido por \citeonline{cai2023improved}, demonstra a capacidade de atenuar o erro associado ao \textit{Fast Iterative Method}, no entanto, apesar dessa melhoria, não se destaca como o mais preciso entre os métodos analisados, evidenciando, por vezes, uma performance inferior em relação às alternativas examinadas. Dentre as formulações avaliadas, a implementação mais precisa revelou-se aquela do \textit{Fast Sweeping Method}, incorporando a estratégia de paralelização proposta por \citeonline{detrixhe2013parallel} e os operadores desenvolvidos no trabalho de \citeonline{noble2014accurate}. Este método, além de apresentar maior precisão, destaca-se pela eficiência computacional, embora não tenha sido o mais performático isoladamente. No entanto, ao considerar o equilíbrio entre precisão e performance, o \textit{Fast Sweeping Method} revela-se promissor, oferecendo uma alternativa viável e equilibrada para a resolução da equação eikonal em cenários homogêneos. 

O método que evidenciou o mais elevado desempenho computacional foi a forma original do \textit{Fast Iterative Method}, superando em 37\% a formulação proposta por \citeonline{podvin1991finite}, em 24\% considerando o \textit{Fast Sweeping Method} e em expressivos 68\% em relação ao método aprimorado por \citeonline{cai2023improved}. Em instâncias de problemas com dimensões reduzidas, não se observam grandes disparidades nos tempos de execução, ou seja, as diferenças apesar de expressivas, são insignificantes. Nesse contexto, o componente crucial a ser analisado, especialmente em modelos homogêneos, é a precisão. Dentre os métodos avaliados, o \textit{Fast Sweeping Method} se destaca por apresentar a menor discrepância em relação à formulação analítica. Considerando apenas o erro máximo, conforme disposto na Tabela \ref{table_homog}, este método revela reduções significativas de 90\% em comparação com a formulação de \citeonline{podvin1991finite}, 94\% em relação à versão original do \textit{Fast Iterative Method} e 75\% em relação ao \textit{Fast Iterative Method} com operadores precisos. Essa análise apurada não apenas destaca as diferenças de desempenho entre os métodos, mas também ressalta a superioridade do \textit{Fast Sweeping Method} em termos de precisão, consolidando sua posição como uma escolha promissora para aplicações que demandam alta acurácia em modelos homogêneos.

\section{Aplicação em modelo de refração}

A Tabela \ref{table_refModel} oferece uma visão detalhada dos resultados obtidos em um teste de escalabilidade para cada método avaliado. Este teste foi essencial para compreender a capacidade de lidar com o problema em domínios distintos. É importante ressaltar que a análise de reciprocidade desempenha um papel crucial, tornando-se evidente a identificação de possíveis vazamentos de memória quando aplicado múltiplas posições de tiro. Além disso, a validação em aplicações de imageamento sísmico também é contemplada através do estudo de reciprocidade. O tempo de execução assume uma importância crítica na geração eficiente de resultados nessas aplicações. A capacidade dos métodos em manter um desempenho consistente e eficaz, mesmo em cenários de maior exigência computacional, reforça a confiança na sua aplicabilidade prática em contextos mais desafiadores. 

\begin{table}[H]
	\caption{Tempo de execução para cada discretização e reciprocidade para o modelo de 25 m.}
	\begin{tabular}{r|cccc}
		& 100 m    & 50 m     & 25 m     & Reciprocidade \\ \hline
		\citeonline{podvin1991finite}   & 0,0676 s & 0,3141 s & 3,5324 s & 7896,2 s        \\ \hline
		\citeonline{jeong2008fast} & 0,0491 s & 0,0987 s & 0,6261 s & 921,8 s              \\ \hline
		\citeonline{noble2014accurate} & 0,1042 s & 0,2286 s & 0,8284 s & 1382,5 s          \\
	\end{tabular}
	\label{table_refModel}
\end{table}

Os resultados apresentados na Tabela \ref{table_refModel} evidenciam distintos contextos de desempenho. No cenário envolvendo o problema de menor escala, destaca-se a formulação proposta por \citeonline{jeong2008fast}, demonstrando uma vantagem de 27\% e 52\% sobre as formulações de \citeonline{podvin1991finite} e \citeonline{noble2014accurate}, respectivamente. À medida que nos deparamos com o problema de escala intermediária, utilizando a discretização de 50 metros, o \textit{Fast Iterative Method} persiste como o líder em desempenho, apresentando uma superioridade de 68\% e 56\% em relação às formulações de \citeonline{podvin1991finite} e \citeonline{noble2014accurate}, respectivamente. Por fim, no problema de maior densidade de pontos, com a discretização do modelo de 25 metros, a formulação de \citeonline{jeong2008fast} mantém sua posição de destaque, superando em 82\% e 32\% as formulações de \citeonline{podvin1991finite} e \citeonline{noble2014accurate}, respectivamente. Referindo-se ao problema de reciprocidade, após a realização de 1252 disparos com a equação eikonal, observa-se que o \textit{Fast Iterative Method} apresentou o melhor desempenho, evidenciando uma eficiência de 88\% e 33\% em relação às formulações de \citeonline{podvin1991finite} e \citeonline{noble2014accurate}, respectivamente. Vale ressaltar que o estudo de reciprocidade foi conduzido no modelo com espaçamento de 25 metros, o que resultou em métricas percentuais semelhantes entre os estudos de propagação direta e de reciprocidade. Outro ponto relevante a destacar é o melhor desempenho da formulação de \citeonline{noble2014accurate} com o esquema de paralelização proposto por \citeonline{detrixhe2013parallel} em problemas de larga escala em comparação aos demais cenários.

As Figuras \ref{fig:general_refraction_study}, \ref{fig:precision_refraction_study}, e \ref{fig:reciprocity_refraction_study} oferecem uma visão do estudo de precisão, fornecendo detalhes significativos sobre os tempos calculados que percorrem a trajetória desde a fonte até os receptores, tempos diretos, e vice-versa, tempos recíprocos. Cada uma destas figuras destaca informações cruciais sobre o comportamento da solução dos métodos utilizados, representados por cores específicas. O tom azul está associado à formulação proposta por \citeonline{podvin1991finite}, enquanto o amarelo denota a abordagem de \citeonline{jeong2008fast}, e o verde representa a formulação desenvolvida por \citeonline{noble2014accurate}. Além disso, os diferentes estilos de linha desempenham um papel fundamental na comunicação visual, indicando os diversos parâmetros de discretização adotados. Notavelmente, as linhas sólidas representam o modelo com espaçamento de 25 metros, as linhas tracejadas correspondem ao modelo de 50 metros, e as linhas com ponto e traço caracterizam o modelo de 100 metros. Essa diferenciação visual proporciona uma compreensão mais profunda das variações nos resultados, permitindo uma análise mais refinada das influências do parâmetro de discretização nos tempos calculados. 

\begin{figure}[H]
	\centering
	\subfloat[]{\includegraphics[width=15cm,height=5.4cm]{Imgs/RevisaoBibliografica/precision_direct.png}\label{fig:rnca}}\newline
	\subfloat[]{\includegraphics[width=15cm,height=5.4cm]{Imgs/RevisaoBibliografica/reciprocity.png}\label{fig:rncb}} 
	\caption{Panorama geral do comportamento dos tempos de trânsito para todos os métodos estudados. (a) exibe a variação para cada discretização do modelo de velocidade e (b) mostra somente o estudo de reciprocidade aplicado no modelo de 25 m.}
	\label{fig:general_refraction_study}	
\end{figure}

A Figura \ref{fig:general_refraction_study}a) oferece uma visão da configuração de todos os métodos em relação ao tiro central, onde a linha sólida preta representa o tempo analítico associado ao experimento. Essa representação visual permite a comparação direta entre os tempos calculados pelos diferentes métodos e o referencial analítico. Já na Figura \ref{fig:general_refraction_study}b), os tempos registrados são apresentados, utilizando o princípio da reciprocidade, no modelo com discretização de 25 metros. Nesse contexto, é relevante observar que os tempos esperados para esse caso específico se manifestariam como retas horizontais, mantendo-se constantes, dado que o modelo é caracterizado por homogeneidade lateral. Dessa forma, a combinação das informações visuais dessas duas figuras não apenas destaca a configuração geral dos métodos no tiro central, mas também fornece características valiosos sobre a precisão e consistência dos tempos registrados, especialmente quando aplicado o princípio da reciprocidade em um modelo com discretização específica. A configuração sinuosa dos tempos de trânsito é uma característica resultante da solução eikonal implementada em coordenadas cartesianas \cite{white2020pykonal}, em que ângulos de incidência múltiplos de $\pi / 2$ apresentam menores índices de erro.    

\begin{figure}[H]
	\centering
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_pod_direct.png}\label{fig:rncc}}\newline
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_fim_direct.png}\label{fig:rnce}}\newline
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_fsm_direct.png}\label{fig:rncg}}\newline
		
	\caption{Diferença entre os tempos analítico $t_a$ e numérico $t_n$ por método em relação aos parâmetros de discretização do modelo. (a) o método clássico de \citeonline{podvin1991finite}, (b) o FIM e (c) o FSM utilizando discretizações de 100, 50 e 25 m.}
	\label{fig:precision_refraction_study}	
\end{figure}

A análise visual apresentada na Figura \ref{fig:precision_refraction_study} revela um fenômeno significativo: à medida que a malha de discretização se torna mais esparsa, a discrepância entre a solução analítica e a solução numérica aumenta. Essa observação sugere que os erros associados à solução numérica são proporcionais ao nível de refinamento do modelo, um padrão que emerge das inerentes limitações do método das diferenças finitas. A peculiaridade desse comportamento destaca a sensibilidade do método às características da malha utilizada na discretização do problema. Em outras palavras, a escolha da resolução da malha tem um impacto direto na precisão da solução numérica. Este fenômeno é uma manifestação das limitações intrínsecas do método das diferenças finitas, que, ao lidar com malhas mais esparsas, tende a introduzir erros significativos na estimativa dos tempos de trânsito. Diante dessa constatação, surge a necessidade de estratégias para aprimorar a precisão da solução numérica. Uma abordagem sugerida é a ampliação do operador de diferenças finitas, incorporando mais pontos vizinhos no cálculo dos tempos de trânsito \cite{noble2014accurate, cai2023improved}. Assim o aumento da ordem dos operadores visa mitigar os efeitos negativos da esparsidade da malha, oferecendo uma alternativa para contornar as limitações inerentes e aprimorar a fidelidade da solução numérica.

A Figura \ref{fig:precision_refraction_study}a) ilustra as discrepâncias entre os tempos analítico e numérico em relação à formulação de \citeonline{podvin1991finite}, evidenciando erros máximos para cada discretização de aproximadamente -30, -70 e -110 ms, para malhas de 25, 50 e 100 m, respectivamente. Já a Figura \ref{fig:precision_refraction_study}b) exibe as diferenças em relação à formulação de \citeonline{jeong2008fast}, revelando erros máximos para cada discretização em torno de -90, -170 e -340 ms. Por fim, a Figura \ref{fig:precision_refraction_study}c) apresenta as variações relacionadas à formulação de \citeonline{noble2014accurate}, indicando erros para cada discretização de aproximadamente -1, -2 e -5 ms, para malhas de 25, 50 e 100 m, respectivamente. Ao analisar as informações sobre precisão apresentadas, o \textit{Fast Sweeping Method} destaca-se pela considerável superioridade, produzindo resultados satisfatórios mesmo no cenário de malha esparsa. A abordagem de \citeonline{noble2014accurate}, quando aplicada em larga escala com uma discretização de 25 metros, resultou em um erro inferior a 1 milissegundo, proporcionando uma representação mais fiel do fenômeno cinemático. Em contrapartida, as demais metodologias revelam uma discrepância negativa em relação à equação analítica, indicando um efeito de redução na velocidade do meio, especialmente quando os tempos de trânsito obtidos são maiores que a solução analítica. 

A Figura \ref{fig:reciprocity_refraction_study} evidencia claramente a superioridade em precisão do \textit{Fast Sweeping Method}. No entanto, durante o desenvolvimento do estudo de reciprocidade, a etapa de inicialização gerou instabilidades no processo de modelagem, conforme destacado na Figura \ref{fig:reciprocity_refraction_study}c. Na fase inicial do cálculo dos tempos de trânsito, todo o volume foi inicializado com um valor tendendo ao infinito, enquanto apenas os pontos vizinhos à fonte receberam inicialização com base no tempo analítico para velocidade constante, conforme indicado pela equação \ref{analyticalT}. O procedimento original proposto por \citeonline{noble2014accurate} implementa a inicialização analítica exclusivamente nos pontos do primeiro octante. Contudo, o estudo de reciprocidade revelou a necessidade de estender essa inicialização aos pontos vizinhos em todas as direções, ou seja, nos oito octantes circundantes à fonte, conforme exemplificado na Figura \ref{fig:voxel_full}.

\begin{figure}[H]
	\centering
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_pod_reciprocity.png}\label{fig:rncd}}\newline
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_fim_reciprocity.png}\label{fig:rncf}}\newline
	\subfloat[]{\includegraphics[width=15cm,height=3cm]{Imgs/RevisaoBibliografica/error_fsm_reciprocity.png}\label{fig:rnch}}
	
	\caption{Sobreposição entre os erros dos tempos de trânsito diretos, da fonte para os receptores, e recíprocos, dos receptores para a fonte, em relação à equação analítica. Diferença analítico $t_a$ e numérico $t_n$ em relação aos métodos (a) clássico, (b) FIM e (c) FSM somente para a discretização de 25 m entre os pontos da malha.}  
	\label{fig:reciprocity_refraction_study}
\end{figure}

Após a implementação das correções no algoritmo, procedeu-se a uma nova modelagem utilizando o princípio da reciprocidade, reforçando ainda mais a precisão do \textit{Fast Sweeping Method}, conforme representado pela linha tracejada verde na Figura \ref{fig:reciprocity_refraction_study}c. Cabe destacar que, mesmo diante dessas melhorias, a análise revela alguns erros de interpolação na Figura \ref{fig:reciprocity_refraction_study}. Esses equívocos são atribuíveis à localização dos pontos considerados no círculo de receptores, os quais se encontram fora da malha. Entretanto, é relevante notar que esses erros assumem valores discretos em relação às diferenças entre os tempos analítico e numérico, constituindo um aspecto importante a ser considerado na avaliação da fidedignidade do método.

\section{Aplicação em modelo complexo}

As Figuras \ref{fig:overthrust_inner_circle}, \ref{fig:overthrust_mid_circle} e \ref{fig:overthrust_outer_circle} mostram os resultados gerados a partir do esquema de modelagem com geometria circular aplicado no modelo SEG/EAGE \textit{Overthrust}. Novamente as cores da figura indicam cada método, sendo a cor azul para a formulação de \citeonline{podvin1991finite}, laranja para \citeonline{jeong2008fast} e verde para a formulação de \citeonline{noble2014accurate}. As figuras são ampliações do sismograma de primeira chegada com uma seleção de estações que evidencia a disparidade entre os tempos de trânsito. Como a equação eikonal é uma aproximação da equação da onda para altas frequências, espera-se que os detalhes do modelo sejam identificados no dado, então, as janelas amplificadoras facilitam a identificação desses aspectos.    

\begin{figure}[H]
	\centering
	\includegraphics[height=8cm,width=13cm]{Imgs/Resultados/complex_w1.png}		
	\caption{Tempos de trânsito capturados do circulo menor de 5,5 km. As cores representam cada solução numérica, sendo azul para o método clássico, laranja para o FIM e verde para o FSM. O eixo horizontal representa o índice dos receptores entre as 5662 estações e o eixo vertical é o tempo de percurso da frente de onda.}
	\label{fig:overthrust_inner_circle}
\end{figure}

O atraso intrínseco das formulações de \citeonline{podvin1991finite} e \citeonline{jeong2008fast} pode ser notado no modelo complexo assim como foi notado utilizando o modelo simples com duas camadas. A formulação de \citeonline{noble2014accurate} se mostra superior em relação aos atrasos no tempo de trânsito por consequência dos tempos maiores observados nos demais métodos.

\begin{figure}[H]
	\centering
	\includegraphics[height=8cm,width=13cm]{Imgs/Resultados/complex_w2.png}	
	\caption{Tempos de trânsito capturados do circulo intermediário de 7,5 km. As cores representam cada solução numérica, sendo azul para o método clássico, laranja para o FIM e verde para o FSM. O eixo horizontal representa o índice dos receptores entre as 5662 estações e o eixo vertical é o tempo de percurso da frente de onda.}
	\label{fig:overthrust_mid_circle}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[height=8cm,width=13cm]{Imgs/Resultados/complex_w3.png} \newline 
	
	\caption{Tempos de trânsito capturados do círculo maior de 9,5 km. As cores representam cada solução numérica, sendo azul para o método clássico, laranja para o FIM e verde para o FSM. O eixo horizontal representa o índice dos receptores entre as 5662 estações e o eixo vertical é o tempo de percurso da frente de onda.}
	\label{fig:overthrust_outer_circle}
\end{figure}

A Tabela \ref{table_overthrust} apresenta os tempos de execução para cada método utilizando o modelo complexo em geometria circular aplicando somente um tiro no centro do modelo. A superioridade de performance é atribuída ao método de \citeonline{jeong2008fast}, porém essa metodologia possui atrasos severos em relação aos tempos de trânsito calculados comparado à equação analítica e aos demais métodos testados.

\begin{table}[H]
	\caption{Tempo de execução para a aplicação dos métodos no modelo complexo.}
	\begin{tabular}{r|c}
		& Tempo de execução \\ \hline
		\citeonline{podvin1991finite} & 11,7128 s  \\ \hline
		\citeonline{jeong2008fast} & 2,5595 s      \\ \hline
		\citeonline{noble2014accurate} & 3,4746 s         
	\end{tabular}
	\label{table_overthrust}
\end{table}

A aplicação dos métodos no modelo complexo foi realizada com sucesso, então, os tempos de trânsito (Figuras \ref{fig:overthrust_inner_circle}, \ref{fig:overthrust_mid_circle} e \ref{fig:overthrust_outer_circle}) e de execução (Tabela \ref{table_overthrust}) foram registrados. Novamente, o método clássico demonstrou tempo de execução acima dos demais para problemas grandes. O método de \citeonline{jeong2008fast} demonstra eficiência computacional e o \textit{Fast Sweeping Method} performa 26$\%$ abaixo do método mais performático. Considerando o ganho de precisão, a diferença de performance pode ser desconsiderada pois \citeonline{cai2023improved} mostram a utilização do método original de \citeonline{jeong2008fast} na migração Kirchhoff em profundidade, onde os erros de posicionamento dos refletores são amplamente perceptíveis. Os tempos de trânsito ilustrados nas Figuras \ref{fig:overthrust_inner_circle}, \ref{fig:overthrust_mid_circle} e \ref{fig:overthrust_outer_circle} mostram as discrepâncias entre os métodos aplicados ao modelo SEG/EAGE \textit{Overthrust}, sendo que os atrasos percebidos na Figura \ref{fig:precision_refraction_study} se repetem, porém no modelo complexo. Se mostra visível nas Figuras \ref{fig:overthrust_inner_circle}, \ref{fig:overthrust_mid_circle} e \ref{fig:overthrust_outer_circle} os detalhes que o modelo impõe aos tempos de trânsito, nas formulações de \citeonline{podvin1991finite} e \citeonline{noble2014accurate}, e a falta de definição para a formulação menos precisa de \citeonline{jeong2008fast}.  





